function getData(){$.ajax({url:"/daily_sugar",dataType:"json",success:sugarTotal}),$("#sugar-btns div ").on("click",function(){"daily"==this.id?($(this).addClass("selected"),$("#weekly").removeClass("selected"),$.ajax({url:"/daily_sugar",dataType:"json",success:sugarTotal})):($(this).addClass("selected"),$("#daily").removeClass("selected"),$.ajax({url:"/weekly_sugar",dataType:"json",success:sugarTotal}))})}function totalCups(a){$("#sugar-show").empty();for(var t=Math.max(parseInt(1+Math.max(a-1,0)/200)),e=0;t>e;e++){var r=$('<div class="cup-and-sugar"><div class="cup"></div><svg id="sugar-containter-'+e+'"></svg></div>');$("#sugar-show").append(r)}}var sugarTotal=function(a){var t=0;$.each(a,function(a,e){t+=parseInt(e.amount)}),totalCups(t);var e=parseInt(1+Math.max(t-1,0)/200);$("#total").html("Your Total: "+t+"g");for(var r=0;e>r;r++){if(e-1>r)var s=200;else var s=t%200;setSugarContainer([s],r)}},setSugarContainer=function(a,t){var e=$(".cup").height(),r=$(".cup").width(),s=d3.select("#sugar-containter-"+t).attr("width",r).attr("height",e),n=d3.scale.linear().domain([0,200]).range([.15*e,.72*e]);s.selectAll("rect").data(a).exit().remove(),s.selectAll("rect").data(a).enter().append("rect"),s.selectAll("rect").data(a).attr("height",function(){return 0}).attr("width",r).attr("x",function(){return 0}).attr("y",function(){return e}).attr("fill","#DCDCDC").transition().duration(1e3).ease("bounce").attr("height",function(a){return n(a)}).attr("y",function(a){return e-n(a)})};window.onload=function(){getData()};